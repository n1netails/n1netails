.ai-chat-card {
    margin-top: 8px;
}

.ai-chat-card .chat-card-content {

  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 400px;
}

.chat-virtual-scroll-container {
  flex: 1 1 auto;
  min-height: 0;
  height: 100%;      // Add this line
  overflow: hidden;
  display: flex;     // Ensure flex context for children
  flex-direction: column;
}

.chat-virtual-scroll-viewport {
  width: 100% !important;
  height: 100% !important;   // Ensure it fills the container
  min-height: 500px;         // Or your preferred min height
  flex: 1 1 auto;
  border-radius: 8px;
  background: transparent;
}

.chat-input-area {
  display: flex;
  align-items: flex-end;
  gap: 0;
  margin-top: 12px;
  width: 100%; // .chat-input-area should span full width of its parent
  background: transparent;

  // Target the textarea's nz-form-item (direct child, not .action-buttons)
  > nz-form-item:not(.action-buttons) {
    flex: 1 1 auto; // Allow it to grow and shrink. Crucial for desktop.
    min-width: 0;   // Allow it to shrink below its intrinsic content size. Also crucial.

    @media (max-width: @screen-sm-max) {
      width: 100%; // On mobile, it takes full width when stacked
      flex-basis: auto; // Reset flex-basis for stacked layout if needed
      padding-bottom: 20px; // Space for character count
    }
  }

  // Target the action buttons' nz-form-item
  > nz-form-item.action-buttons {
    flex-shrink: 0; // Prevent button group from shrinking on desktop
    // Other styles for mobile are below in the media query
  }

  // Ensure textarea itself is always 100% of its parent form item
  textarea {
    width: 100% !important;
    resize: vertical; // Allow vertical resize, disable horizontal
  }

  @media (max-width: @screen-sm-max) {
    flex-direction: column;
    gap: 12px;

    // Styling for the form item containing the action buttons on mobile
    nz-form-item.action-buttons {
      margin-left: 0;
      width: 100%;

      button[nz-button] {
        flex: 1;
      }
    }
  }
}

.chat-textarea { // This class is indeed unused.
  // ... (can be removed if not planned for use)
}

// General styles for .action-buttons (which is a class on nz-form-item)
.action-buttons {
  // Desktop styles are mostly inline + the flex-shrink above.
  // Mobile styles are in the media query.
  button[nz-button] {
     // min-width: 100px; // Keeping this from previous, could be useful
     // Ensure buttons don't get overly squished if there are many.
     // For two buttons with flex:1 on mobile, this might not be strictly needed
     // but doesn't hurt unless it breaks the flex:1 behavior.
  }
}
